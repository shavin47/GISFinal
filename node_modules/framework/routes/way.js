exports.addWay=function(req, res)
{
	var db = req.db;
	var collection = db.get("waycollection");

	if(req.body.wayname == "" | req.body.startposlat == "" | req.body.startposlong == "" | req.body.endposlat == "" | req.body.endposlong == "")
	{
		res.send("Please enter the Way Name and starting/ending position (latitude and longitude)");
	}
	else if(-90.0 > parseFloat(req.body.startposlat) > 90.0 | -180.0 > parseFloat(req.params.startposlong > 180) | -90.0 > parseFloat(req.body.endposlat) > 90.0 | -180.0 > parseFloat(req.body.endposlong > 180))
	{
		res.send("Please enter correct range for starting/ending position latitude and longitude");
	}
	else
	{
		collection.insert({
			"name" : req.body.wayname,
			"startposlat" : req.body.startposlat, 
			"startposlong" : req.body.startposlong,
			"endposlat" : req.body.endposlat,
			"endposlong" : req.body.endposlong
		}, function(err, doc){
			if(err)
			{
				res.send(err)
			}				
			else
			{
				res.send("Way successfully added!")
			}				
		});

	}

}

exports.viewWay=function(req, res)
{
	var db = req.db; 
	var collection = db.get('waycollection');

	if(req.params.name == undefined)
	{
		res.send("Please enter a way name");
	}
	else
	{
		collection.find({name : req.params.name}, {}, function(e, docs){
			var startMarkers = new Array(docs.length); 
			var endMarkers = new Array(docs.length);
			var i=0; 
			var theWay; 

			if(docs.length == 0)
			{
				res.send("Way not found!");
			}
			else
			{
				for(theWay in docs)
				{
					startMarkers[i] = [docs[i].startposlat, docs[i].startposlong];
					endMarkers[i] = [docs[i].endposlat, docs[i].endposlong];
					i++;
				}

				res.render('../views/waymap.jade', {title: req.params.name + " Way", "startMarkers" : startMarkers, "endMarkers" : endMarkers});
			}
			
		});
	}

}

exports.deleteWay=function(req, res)
{
	var db = req.db; 
	var collection = db.get('waycollection');

	if(req.params.name == undefined)
	{
		res.send("Please enter a way name");
	}	
	else
	{
		collection.find({name : req.params.name}, {}, function(e, docs){
		
		if(docs.length == 0)
		{
			res.send("Way not found");
		}
		else
		{
			collection.remove({name : req.params.name}, {}, function(e, removed){
			
			res.send("Way successfully deleted!");

			});
		}

		})
	}
	

	
	
}